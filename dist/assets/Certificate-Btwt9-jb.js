import{c as Z,r as f,j as e,ad as ve,ae as Ne,af as ce,ag as Ee,P as F,i as Se}from"./index-CzkBdf-o.js";var ee={exports:{}},Te=ee.exports,le;function be(){return le||(le=1,(function(N,E){(function(S,m){m()})(Te,function(){function S(a,s){return typeof s>"u"?s={autoBom:!1}:typeof s!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}function m(a,s,p){var o=new XMLHttpRequest;o.open("GET",a),o.responseType="blob",o.onload=function(){u(o.response,s,p)},o.onerror=function(){console.error("could not download file")},o.send()}function T(a){var s=new XMLHttpRequest;s.open("HEAD",a,!1);try{s.send()}catch{}return 200<=s.status&&299>=s.status}function c(a){try{a.dispatchEvent(new MouseEvent("click"))}catch{var s=document.createEvent("MouseEvents");s.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(s)}}var l=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Z=="object"&&Z.global===Z?Z:void 0,$=l.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),u=l.saveAs||(typeof window!="object"||window!==l?function(){}:"download"in HTMLAnchorElement.prototype&&!$?function(a,s,p){var o=l.URL||l.webkitURL,r=document.createElement("a");s=s||a.name||"download",r.download=s,r.rel="noopener",typeof a=="string"?(r.href=a,r.origin===location.origin?c(r):T(r.href)?m(a,s,p):c(r,r.target="_blank")):(r.href=o.createObjectURL(a),setTimeout(function(){o.revokeObjectURL(r.href)},4e4),setTimeout(function(){c(r)},0))}:"msSaveOrOpenBlob"in navigator?function(a,s,p){if(s=s||a.name||"download",typeof a!="string")navigator.msSaveOrOpenBlob(S(a,p),s);else if(T(a))m(a,s,p);else{var o=document.createElement("a");o.href=a,o.target="_blank",setTimeout(function(){c(o)})}}:function(a,s,p,o){if(o=o||open("","_blank"),o&&(o.document.title=o.document.body.innerText="downloading..."),typeof a=="string")return m(a,s,p);var r=a.type==="application/octet-stream",W=/constructor/i.test(l.HTMLElement)||l.safari,B=/CriOS\/[\d]+/.test(navigator.userAgent);if((B||r&&W||$)&&typeof FileReader<"u"){var C=new FileReader;C.onloadend=function(){var R=C.result;R=B?R:R.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=R:location=R,o=null},C.readAsDataURL(a)}else{var b=l.URL||l.webkitURL,A=b.createObjectURL(a);o?o.location=A:location.href=A,o=null,setTimeout(function(){b.revokeObjectURL(A)},4e4)}});l.saveAs=u.saveAs=u,N.exports=u})})(ee)),ee.exports}var Ae=be();function de({firstName:N,CollegeName:E,FATHER_NAME:S,REG_NO:m,coursename:T,certificate_type:c,yop:l,coursecertificatr:$,Gender:u,Role:a,To:s,From:p,department:o,qualification:r}){console.log("Received props:",{firstName:N,CollegeName:E,FATHER_NAME:S,REG_NO:m,coursename:T,certificate_type:c,yop:l,Gender:u,Role:a,department:o,To:s,From:p,qualification:r});const W="/image/default.png",B=j=>{if(!j)return"";const g=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],[M,y,z]=j.split("-");return`${parseInt(z)}-${g[parseInt(y)-1]}-${M}`},C=B(p),b=B(s),A=j=>`/image/${j}.jpg`,[R,te]=f.useState(""),ae=(j,g=!1)=>(g?j.toLowerCase():j).replace(/(?:^|\s|["'([{])+\S/g,M=>M.toUpperCase()),se=async()=>{const j=N?N.trim():"";if(j!==""&&c!==""&&r!=="")try{let g="";r.toUpperCase()==="BE"?c.toLowerCase()==="internship"?g="/BEINTERNSHIP.pdf":c.toLowerCase()==="project"&&(g="/BEPROJECT.pdf"):r.toUpperCase()==="DIPLOMA"&&(c.toLowerCase()==="internship"?g="/DIPLOMAINTERNSHIP.pdf":c.toLowerCase()==="project"&&(g="/DIPLOMAPROJECT.pdf"));const M=await fetch(g).then(h=>h.arrayBuffer()),y=await ve.load(M);y.registerFontkit(Ne);const z=await fetch("/fonts/Sanchez-Regular.ttf").then(h=>h.arrayBuffer()),x=await fetch("/fonts/NunitoSans_10pt-Bold.ttf").then(h=>h.arrayBuffer()),ne=await fetch("/fonts/NunitoSans_7pt_SemiExpanded-SemiBold.ttf").then(h=>h.arrayBuffer()),U=await y.embedFont(z),w=await y.embedFont(x),Q=await y.embedFont(ne),k=y.getPages()[0],{width:H,height:re}=k.getSize(),n={BE:{internship:{name:{x:"center",y:340,fontSize:34},content:{x:110,y:305,fontSize:13.5,maxWidth:650,rightMargin:110,lineSpacing:22},qrCode:{x:295,y:77,width:100,height:90}},project:{name:{x:"center",y:370,fontSize:30},content:{x:130,y:330,fontSize:14,maxWidth:650,rightMargin:130,lineSpacing:22},qrCode:{x:290,y:50,width:100,height:90}}},DIPLOMA:{internship:{name:{x:"center",y:360,fontSize:32},content:{x:160,y:325,fontSize:13,maxWidth:620,rightMargin:160,lineSpacing:22},qrCode:{x:390,y:110,width:80,height:80}},project:{name:{x:"center",y:330,fontSize:30},content:{x:140,y:290,fontSize:13,maxWidth:620,rightMargin:140,lineSpacing:22},qrCode:{x:370,y:90,width:75,height:70}}}}[r.toUpperCase()][c.toLowerCase()],D=ae(j),O=U.widthOfTextAtSize(D,n.name.fontSize),J=n.name.x==="center"?(H-O)/2:n.name.x;k.drawText(D,{x:J,y:n.name.y,size:n.name.fontSize,font:U,color:ce(0,0,0)});let q="";c.toLowerCase()==="internship"?q=u==="MALE"?`This is to certify that student from "${E}" has completed their internship work from ${C} to ${b} at Excerpt Technologies Private Limited.

He has successfully & satisfactorily completed assigned project work. During his tenure as a "${a}" we found him sincere, hardworking, and result-oriented.

We wish him great success in all of his future endeavors.`:`This is to certify that student from "${E}" has completed their internship work from ${C} to ${b} at Excerpt Technologies Private Limited.

She has successfully & satisfactorily completed assigned project work. During her tenure as a "${a}" we found her sincere, hardworking, and result-oriented.

We wish her great success in all of her future endeavors.`:c.toLowerCase()==="project"&&(q=u==="MALE"?`This is to certify that student from ${E} has completed their project work from ${C} to ${b} at Excerpt Technologies Private Limited.

He has successfully & satisfactorily completed assigned project work. During his tenure as a ${a} we found him sincere, hardworking, and result-oriented.

We wish him great success in all of his future endeavors.`:`This is to certify that student from ${E} has completed their project work from ${C} to ${b} at Excerpt Technologies Private Limited.

She has successfully & satisfactorily completed assigned project work. During her tenure as a ${a} we found her sincere, hardworking, and result-oriented.

We wish her great success in all of her future endeavors.`);const d=(h,L,G,_,P)=>{k.drawText(h,{x:L,y:G,size:_,font:P,color:ce(0,0,0)})},i=(h,L,G,_,P,oe,je)=>{const X=h.split(" ");let I="",K=G;for(let Y=0;Y<X.length;Y++){const ye=I===""?X[Y]:" "+X[Y],ie=I+ye;oe.widthOfTextAtSize(ie,P)>_&&I!==""?(d(I,L,K,P,oe),I=X[Y],K-=je):I=ie}return I&&d(I,L,K,P,oe),K};if(q!==""){const h=q.split(`
`);let L=n.content.y;const G=n.content.lineSpacing||20,_=10;for(const P of h){if(P.trim()===""){L-=_;continue}L=i(P,n.content.x,L,n.content.maxWidth,n.content.fontSize,Q,G),L-=_}}const v=`https://www.excerptech.com/certificate.html?REG_NO=${m}`;te(v);const he={color:{dark:"#000"},errorCorrectionLevel:"H",width:200,type:"png",transparent:!0},pe=await Ee.toDataURL(v,he),fe=Uint8Array.from(atob(pe.split("base64,")[1]),h=>h.charCodeAt(0)),me=await y.embedPng(fe);k.drawImage(me,{x:n.qrCode.x,y:n.qrCode.y,width:n.qrCode.width,height:n.qrCode.height});const ue=await fetch("/image/stamp.jpeg").then(h=>h.arrayBuffer()),ge=await new Blob([ue],{type:"image/jpeg"}).arrayBuffer(),xe=await y.embedJpg(ge),V={BE:{internship:{x:410,y:77,width:100,height:90},project:{x:395,y:70,width:80,height:70}},DIPLOMA:{internship:{x:495,y:110,width:80,height:80},project:{x:490,y:90,width:75,height:70}}}[r.toUpperCase()][c.toLowerCase()];k.drawImage(xe,{x:V.x,y:V.y,width:V.width,height:V.height});const we=await y.save(),Ce=new File([we],"Certificate.pdf",{type:"application/pdf;charset=utf-8"});Ae.saveAs(Ce)}catch(g){console.error("Error generating or downloading certificate:",g),alert("Error generating or downloading certificate. Please try again later.")}else alert("Please enter a name, select a qualification, and select a certificate type.")};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"card shadow",children:[e.jsxs("div",{style:{textAlign:"justify"},children:[e.jsx("img",{className:"image",src:A(m)||W,alt:"Student"}),e.jsx("br",{}),e.jsx("br",{}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"NAME:"})," ",N]}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"REG_NO:"})," ",m]}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"FATHER_NAME:"})," ",S]}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"COURSETITLE:"})," ",T]}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"COOLEGENAME:"})," ",E]}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"CERTIFICATION:"})," ",c]}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"YOP:"})," ",l]}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"COURSECERTIFICATION:"})," ",$]}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"GENDER:"})," ",u]}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"Role:"})," ",a]})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:se,style:{marginLeft:"-9px",width:"200px",marginTop:"10px"},children:"Get Certificate"}),e.jsx("a",{style:{marginLeft:"180px"},href:`https://www.excerptech.com/certificate.html?REG_NO=${m}`,target:"_blank",rel:"noopener noreferrer",children:"View Certificate"})]})]})})}de.propTypes={firstName:F.string.isRequired,REG_NO:F.string.isRequired,FATHER_NAME:F.string.isRequired,coursename:F.string.isRequired,CollegeName:F.string.isRequired,Course_Title:F.string.isRequired,certificate_type:F.string.isRequired,yop:F.string.isRequired};function Le(){const[N,E]=f.useState([]),[S,m]=f.useState([]),[T,c]=f.useState(""),[l,$]=f.useState(""),[u,a]=f.useState(""),[s,p]=f.useState(""),[o,r]=f.useState([]),[W,B]=f.useState([]),[C,b]=f.useState(""),[A,R]=f.useState("");f.useEffect(()=>{te()},[]);const te=async()=>{try{const t=await Se.get("/api/students");E(t.data),console.log("Fetched students:",t.data);const n=[...new Set(t.data.map(O=>O.college_name))],D=[...new Set(t.data.map(O=>O.yop))];r(n),B(D)}catch(t){console.error("Error fetching data:",t)}};f.useEffect(()=>{z(T,l,C,A,u,s)},[N,T,l,C,A,u,s]),console.log("Filtered students:",S);const ae=t=>c(t.target.value),se=t=>$(t.target.value),j=t=>b(t.target.value),g=t=>R(t.target.value),M=t=>a(t.target.value),y=t=>p(t.target.value),z=(t,n,D,O,J,q)=>{let d=[...N];if(t&&(d=d.filter(i=>i.college_name?.toLowerCase()===t.toLowerCase())),n&&(d=d.filter(i=>i.yop===n)),J&&(d=d.filter(i=>(i.qualification?.toLowerCase()||"")===J.toLowerCase())),q&&(d=d.filter(i=>(i.CERTIFICATION||i.certificate_type||"").toLowerCase()===q.toLowerCase())),D){const i=D.toLowerCase();d=d.filter(v=>v.NAME?.toLowerCase().includes(i)||v.REG_NO?.toLowerCase().includes(i)||v.FATHER_NAME?.toLowerCase().includes(i)||(v.COURSETITLE||v.coursename||"")?.toLowerCase().includes(i))}O&&(d=d.filter(i=>i.REG_NO===O)),d.sort((i,v)=>(i.NAME||"").localeCompare(v.NAME||"")),m(d)},[x,ne]=f.useState(1),U=6,w=Math.ceil(S.length/U),Q=(x-1)*U,k=S.slice(Q,Q+U),H=t=>{t>=1&&t<=w&&(ne(t),window.scrollTo({top:0,behavior:"smooth"}))},re=()=>{const t=[];if(w<=5)for(let n=1;n<=w;n++)t.push(n);else x<=3?t.push(1,2,3,4,"...",w):x>=w-2?t.push(1,"...",w-3,w-2,w-1,w):t.push(1,"...",x-1,x,x+1,"...",w);return t};return e.jsxs(e.Fragment,{children:[e.jsx("section",{className:"sub-header position-relative",style:{height:"10vh"},children:e.jsxs("div",{className:"container d-flex justify-content-between align-items-center",children:[e.jsx("h2",{className:"heading-2 w-20",children:"Certificate"}),e.jsx("h6",{className:"heading-6 w-80 text-end",children:e.jsx("a",{href:"/dashboard",children:"dashboard"})})]})}),e.jsx("div",{className:"container",children:e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-md-2",children:e.jsxs("select",{className:"form-select",value:T,onChange:ae,children:[e.jsx("option",{value:"",children:"College Name"}),o.map((t,n)=>e.jsx("option",{value:t,children:t},n))]})}),e.jsx("div",{className:"col-md-2",children:e.jsxs("select",{className:"form-select",value:l,onChange:se,children:[e.jsx("option",{value:"",children:"YOP"}),W.map((t,n)=>e.jsx("option",{value:t,children:t},n))]})}),e.jsx("div",{className:"col-md-2",children:e.jsxs("select",{className:"form-select",value:u,onChange:M,children:[e.jsx("option",{value:"",children:"Qualification"}),e.jsx("option",{value:"BE",children:"BE"}),e.jsx("option",{value:"Diploma",children:"Diploma"})]})}),e.jsx("div",{className:"col-md-2",children:e.jsxs("select",{className:"form-select",value:s,onChange:y,children:[e.jsx("option",{value:"",children:"Certificate Type"}),e.jsx("option",{value:"INTERNSHIP",children:"Internship"}),e.jsx("option",{value:"PROJECT",children:"Project"})]})}),e.jsx("div",{className:"col-md-2",children:e.jsx("input",{type:"text",className:"form-control",placeholder:"Search...",value:C,onChange:j})}),e.jsx("div",{className:"col-md-2",children:e.jsx("input",{type:"text",className:"form-control",placeholder:"Enter REG_NO...",value:A,onChange:g})})]})}),e.jsx("div",{className:"row",children:k.map((t,n)=>e.jsx("div",{className:"col-xl-4 col-md-4 col-sm-6 col-lg-4 mb-4",children:e.jsx(de,{firstName:t.NAME||"N/A",Gender:t.GENDER||"N/A",CollegeName:t.college_name||"N/A",FATHER_NAME:t.FATHER_NAME||"N/A",REG_NO:t.REG_NO||"N/A",coursename:t.COURSETITLE||t.coursename||"N/A",certificate_type:t.CERTIFICATION||t.certificate_type||"N/A",qualification:t.qualification||"Not Available",department:t.department||"Not Available",yop:t.yop||"N/A",coursecertificatr:t.COURSECERTIFICATION||t.Course_Certificate_Type||"N/A",Role:t.Role||"N/A",From:t.From||"N/A",To:t.To||"N/A"})},n))}),w>1&&e.jsxs("div",{className:"d-flex justify-content-center align-items-center mt-4 flex-wrap",children:[e.jsx("button",{style:{maxWidth:"100px"},className:"btn btn-secondary mx-2",disabled:x===1,onClick:()=>H(x-1),children:"◀ Prev"}),re().map((t,n)=>t==="..."?e.jsx("span",{className:"mx-2 text-muted",children:"..."},n):e.jsx("button",{style:{maxWidth:"3vw"},className:`btn btn-sm mx-1 ${x===t?"btn-primary":"btn-outline-primary"}`,onClick:()=>H(t),children:t},n)),e.jsx("button",{style:{maxWidth:"100px"},className:"btn btn-secondary mx-2",disabled:x===w,onClick:()=>H(x+1),children:"Next ▶"})]})]})}const Fe=()=>e.jsx("div",{children:e.jsx(Le,{})});export{Fe as default};

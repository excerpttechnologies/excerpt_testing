import{c as K,r as p,j as e,ad as we,ae as Ce,af as ie,ag as je,P as I,i as ve}from"./index-DQdMQyEc.js";var Z={exports:{}},ye=Z.exports,ce;function Ne(){return ce||(ce=1,(function(N,E){(function(S,u){u()})(ye,function(){function S(a,n){return typeof n>"u"?n={autoBom:!1}:typeof n!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),n={autoBom:!n}),n.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}function u(a,n,h){var r=new XMLHttpRequest;r.open("GET",a),r.responseType="blob",r.onload=function(){m(r.response,n,h)},r.onerror=function(){console.error("could not download file")},r.send()}function T(a){var n=new XMLHttpRequest;n.open("HEAD",a,!1);try{n.send()}catch{}return 200<=n.status&&299>=n.status}function c(a){try{a.dispatchEvent(new MouseEvent("click"))}catch{var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(n)}}var l=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof K=="object"&&K.global===K?K:void 0,$=l.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),m=l.saveAs||(typeof window!="object"||window!==l?function(){}:"download"in HTMLAnchorElement.prototype&&!$?function(a,n,h){var r=l.URL||l.webkitURL,o=document.createElement("a");n=n||a.name||"download",o.download=n,o.rel="noopener",typeof a=="string"?(o.href=a,o.origin===location.origin?c(o):T(o.href)?u(a,n,h):c(o,o.target="_blank")):(o.href=r.createObjectURL(a),setTimeout(function(){r.revokeObjectURL(o.href)},4e4),setTimeout(function(){c(o)},0))}:"msSaveOrOpenBlob"in navigator?function(a,n,h){if(n=n||a.name||"download",typeof a!="string")navigator.msSaveOrOpenBlob(S(a,h),n);else if(T(a))u(a,n,h);else{var r=document.createElement("a");r.href=a,r.target="_blank",setTimeout(function(){c(r)})}}:function(a,n,h,r){if(r=r||open("","_blank"),r&&(r.document.title=r.document.body.innerText="downloading..."),typeof a=="string")return u(a,n,h);var o=a.type==="application/octet-stream",W=/constructor/i.test(l.HTMLElement)||l.safari,M=/CriOS\/[\d]+/.test(navigator.userAgent);if((M||o&&W||$)&&typeof FileReader<"u"){var C=new FileReader;C.onloadend=function(){var L=C.result;L=M?L:L.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=L:location=L,r=null},C.readAsDataURL(a)}else{var A=l.URL||l.webkitURL,b=A.createObjectURL(a);r?r.location=b:location.href=b,r=null,setTimeout(function(){A.revokeObjectURL(b)},4e4)}});l.saveAs=m.saveAs=m,N.exports=m})})(Z)),Z.exports}var Ee=Ne();function le({firstName:N,CollegeName:E,FATHER_NAME:S,REG_NO:u,coursename:T,certificate_type:c,yop:l,coursecertificatr:$,Gender:m,Role:a,To:n,From:h,department:r,qualification:o}){console.log("Received props:",{firstName:N,CollegeName:E,FATHER_NAME:S,REG_NO:u,coursename:T,certificate_type:c,yop:l,Gender:m,Role:a,department:r,To:n,From:h,qualification:o});const W="/image/default.png",M=j=>{if(!j)return"";const g=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],[k,y,z]=j.split("-");return`${parseInt(z)}-${g[parseInt(y)-1]}-${k}`},C=M(h),A=M(n),b=j=>`/image/${j}.jpg`,[L,ee]=p.useState(""),te=(j,g=!1)=>(g?j.toLowerCase():j).replace(/(?:^|\s|["'([{])+\S/g,k=>k.toUpperCase()),ae=async()=>{const j=N?N.trim():"";if(j!==""&&c!==""&&o!=="")try{let g="";o.toUpperCase()==="BE"?c.toLowerCase()==="internship"?g="/BEINTERNSHIP.pdf":c.toLowerCase()==="project"&&(g="/BEPROJECT.pdf"):o.toUpperCase()==="DIPLOMA"&&(c.toLowerCase()==="internship"?g="/DIPLOMAINTERNSHIP.pdf":c.toLowerCase()==="project"&&(g="/DIPLOMAPROJECT.pdf"));const k=await fetch(g).then(f=>f.arrayBuffer()),y=await we.load(k);y.registerFontkit(Ce);const z=await fetch("/fonts/Sanchez-Regular.ttf").then(f=>f.arrayBuffer()),x=await fetch("/fonts/NunitoSans_10pt-Bold.ttf").then(f=>f.arrayBuffer()),ne=await fetch("/fonts/NunitoSans_7pt_SemiExpanded-SemiBold.ttf").then(f=>f.arrayBuffer()),B=await y.embedFont(z),w=await y.embedFont(x),Q=await y.embedFont(ne),U=y.getPages()[0],{width:H,height:re}=U.getSize(),s={BE:{internship:{name:{x:"center",y:340,fontSize:34},content:{x:110,y:305,fontSize:13.5,maxWidth:650,rightMargin:110,lineSpacing:22},qrCode:{x:295,y:77,width:100,height:90}},project:{name:{x:"center",y:370,fontSize:30},content:{x:130,y:330,fontSize:14,maxWidth:650,rightMargin:130,lineSpacing:22},qrCode:{x:290,y:50,width:100,height:90}}},DIPLOMA:{internship:{name:{x:"center",y:360,fontSize:32},content:{x:160,y:325,fontSize:13,maxWidth:620,rightMargin:160,lineSpacing:22},qrCode:{x:390,y:110,width:80,height:80}},project:{name:{x:"center",y:330,fontSize:30},content:{x:140,y:290,fontSize:13,maxWidth:620,rightMargin:140,lineSpacing:22},qrCode:{x:370,y:90,width:75,height:70}}}}[o.toUpperCase()][c.toLowerCase()],q=te(j),O=B.widthOfTextAtSize(q,s.name.fontSize),J=s.name.x==="center"?(H-O)/2:s.name.x;U.drawText(q,{x:J,y:s.name.y,size:s.name.fontSize,font:B,color:ie(0,0,0)});let D="";c.toLowerCase()==="internship"?D=m==="MALE"?`This is to certify that student from "${E}" has completed their internship work from ${C} to ${A} at Excerpt Technologies Private Limited.

He has successfully & satisfactorily completed assigned project work. During his tenure as a "${a}" we found him sincere, hardworking, and result-oriented.

We wish him great success in all of his future endeavors.`:`This is to certify that student from "${E}" has completed their internship work from ${C} to ${A} at Excerpt Technologies Private Limited.

She has successfully & satisfactorily completed assigned project work. During her tenure as a "${a}" we found her sincere, hardworking, and result-oriented.

We wish her great success in all of her future endeavors.`:c.toLowerCase()==="project"&&(D=m==="MALE"?`This is to certify that student from ${E} has completed their project work from ${C} to ${A} at Excerpt Technologies Private Limited.

He has successfully & satisfactorily completed assigned project work. During his tenure as a ${a} we found him sincere, hardworking, and result-oriented.

We wish him great success in all of his future endeavors.`:`This is to certify that student from ${E} has completed their project work from ${C} to ${A} at Excerpt Technologies Private Limited.

She has successfully & satisfactorily completed assigned project work. During her tenure as a ${a} we found her sincere, hardworking, and result-oriented.

We wish her great success in all of her future endeavors.`);const d=(f,R,G,_,P)=>{U.drawText(f,{x:R,y:G,size:_,font:P,color:ie(0,0,0)})},i=(f,R,G,_,P,se,ge)=>{const V=f.split(" ");let F="",X=G;for(let Y=0;Y<V.length;Y++){const xe=F===""?V[Y]:" "+V[Y],oe=F+xe;se.widthOfTextAtSize(oe,P)>_&&F!==""?(d(F,R,X,P,se),F=V[Y],X-=ge):F=oe}return F&&d(F,R,X,P,se),X};if(D!==""){const f=D.split(`
`);let R=s.content.y;const G=s.content.lineSpacing||20,_=10;for(const P of f){if(P.trim()===""){R-=_;continue}R=i(P,s.content.x,R,s.content.maxWidth,s.content.fontSize,Q,G),R-=_}}const v=`https://www.excerptech.com/certificate.html?REG_NO=${u}`;ee(v);const de={color:{dark:"#000"},errorCorrectionLevel:"H",width:200,type:"png",transparent:!0},he=await je.toDataURL(v,de),fe=Uint8Array.from(atob(he.split("base64,")[1]),f=>f.charCodeAt(0)),pe=await y.embedPng(fe);U.drawImage(pe,{x:s.qrCode.x,y:s.qrCode.y,width:s.qrCode.width,height:s.qrCode.height});const ue=await y.save(),me=new File([ue],"Certificate.pdf",{type:"application/pdf;charset=utf-8"});Ee.saveAs(me)}catch(g){console.error("Error generating or downloading certificate:",g),alert("Error generating or downloading certificate. Please try again later.")}else alert("Please enter a name, select a qualification, and select a certificate type.")};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"card shadow",children:[e.jsxs("div",{style:{textAlign:"justify"},children:[e.jsx("img",{className:"image",src:b(u)||W,alt:"Student"}),e.jsx("br",{}),e.jsx("br",{}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"NAME:"})," ",N]}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"REG_NO:"})," ",u]}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"FATHER_NAME:"})," ",S]}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"COURSETITLE:"})," ",T]}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"COOLEGENAME:"})," ",E]}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"CERTIFICATION:"})," ",c]}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"YOP:"})," ",l]}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"COURSECERTIFICATION:"})," ",$]}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"GENDER:"})," ",m]}),e.jsxs("p",{children:[e.jsx("span",{className:"detail-label",children:"Role:"})," ",a]})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:ae,style:{marginLeft:"-9px",width:"200px",marginTop:"10px"},children:"Get Certificate"}),e.jsx("a",{style:{marginLeft:"180px"},href:`https://www.excerptech.com/certificate.html?REG_NO=${u}`,target:"_blank",rel:"noopener noreferrer",children:"View Certificate"})]})]})})}le.propTypes={firstName:I.string.isRequired,REG_NO:I.string.isRequired,FATHER_NAME:I.string.isRequired,coursename:I.string.isRequired,CollegeName:I.string.isRequired,Course_Title:I.string.isRequired,certificate_type:I.string.isRequired,yop:I.string.isRequired};function Se(){const[N,E]=p.useState([]),[S,u]=p.useState([]),[T,c]=p.useState(""),[l,$]=p.useState(""),[m,a]=p.useState(""),[n,h]=p.useState(""),[r,o]=p.useState([]),[W,M]=p.useState([]),[C,A]=p.useState(""),[b,L]=p.useState("");p.useEffect(()=>{ee()},[]);const ee=async()=>{try{const t=await ve.get("/api/students");E(t.data),console.log("Fetched students:",t.data);const s=[...new Set(t.data.map(O=>O.college_name))],q=[...new Set(t.data.map(O=>O.yop))];o(s),M(q)}catch(t){console.error("Error fetching data:",t)}};p.useEffect(()=>{z(T,l,C,b,m,n)},[N,T,l,C,b,m,n]),console.log("Filtered students:",S);const te=t=>c(t.target.value),ae=t=>$(t.target.value),j=t=>A(t.target.value),g=t=>L(t.target.value),k=t=>a(t.target.value),y=t=>h(t.target.value),z=(t,s,q,O,J,D)=>{let d=[...N];if(t&&(d=d.filter(i=>i.college_name?.toLowerCase()===t.toLowerCase())),s&&(d=d.filter(i=>i.yop===s)),J&&(d=d.filter(i=>(i.qualification?.toLowerCase()||"")===J.toLowerCase())),D&&(d=d.filter(i=>(i.CERTIFICATION||i.certificate_type||"").toLowerCase()===D.toLowerCase())),q){const i=q.toLowerCase();d=d.filter(v=>v.NAME?.toLowerCase().includes(i)||v.REG_NO?.toLowerCase().includes(i)||v.FATHER_NAME?.toLowerCase().includes(i)||(v.COURSETITLE||v.coursename||"")?.toLowerCase().includes(i))}O&&(d=d.filter(i=>i.REG_NO===O)),d.sort((i,v)=>(i.NAME||"").localeCompare(v.NAME||"")),u(d)},[x,ne]=p.useState(1),B=6,w=Math.ceil(S.length/B),Q=(x-1)*B,U=S.slice(Q,Q+B),H=t=>{t>=1&&t<=w&&(ne(t),window.scrollTo({top:0,behavior:"smooth"}))},re=()=>{const t=[];if(w<=5)for(let s=1;s<=w;s++)t.push(s);else x<=3?t.push(1,2,3,4,"...",w):x>=w-2?t.push(1,"...",w-3,w-2,w-1,w):t.push(1,"...",x-1,x,x+1,"...",w);return t};return e.jsxs(e.Fragment,{children:[e.jsx("section",{className:"sub-header position-relative",style:{height:"10vh"},children:e.jsxs("div",{className:"container d-flex justify-content-between align-items-center",children:[e.jsx("h2",{className:"heading-2 w-20",children:"Certificate"}),e.jsx("h6",{className:"heading-6 w-80 text-end",children:e.jsx("a",{href:"/dashboard",children:"dashboard"})})]})}),e.jsx("div",{className:"container",children:e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-md-2",children:e.jsxs("select",{className:"form-select",value:T,onChange:te,children:[e.jsx("option",{value:"",children:"College Name"}),r.map((t,s)=>e.jsx("option",{value:t,children:t},s))]})}),e.jsx("div",{className:"col-md-2",children:e.jsxs("select",{className:"form-select",value:l,onChange:ae,children:[e.jsx("option",{value:"",children:"YOP"}),W.map((t,s)=>e.jsx("option",{value:t,children:t},s))]})}),e.jsx("div",{className:"col-md-2",children:e.jsxs("select",{className:"form-select",value:m,onChange:k,children:[e.jsx("option",{value:"",children:"Qualification"}),e.jsx("option",{value:"BE",children:"BE"}),e.jsx("option",{value:"Diploma",children:"Diploma"})]})}),e.jsx("div",{className:"col-md-2",children:e.jsxs("select",{className:"form-select",value:n,onChange:y,children:[e.jsx("option",{value:"",children:"Certificate Type"}),e.jsx("option",{value:"INTERNSHIP",children:"Internship"}),e.jsx("option",{value:"PROJECT",children:"Project"})]})}),e.jsx("div",{className:"col-md-2",children:e.jsx("input",{type:"text",className:"form-control",placeholder:"Search...",value:C,onChange:j})}),e.jsx("div",{className:"col-md-2",children:e.jsx("input",{type:"text",className:"form-control",placeholder:"Enter REG_NO...",value:b,onChange:g})})]})}),e.jsx("div",{className:"row",children:U.map((t,s)=>e.jsx("div",{className:"col-xl-4 col-md-4 col-sm-6 col-lg-4 mb-4",children:e.jsx(le,{firstName:t.NAME||"N/A",Gender:t.GENDER||"N/A",CollegeName:t.college_name||"N/A",FATHER_NAME:t.FATHER_NAME||"N/A",REG_NO:t.REG_NO||"N/A",coursename:t.COURSETITLE||t.coursename||"N/A",certificate_type:t.CERTIFICATION||t.certificate_type||"N/A",qualification:t.qualification||"Not Available",department:t.department||"Not Available",yop:t.yop||"N/A",coursecertificatr:t.COURSECERTIFICATION||t.Course_Certificate_Type||"N/A",Role:t.Role||"N/A",From:t.From||"N/A",To:t.To||"N/A"})},s))}),w>1&&e.jsxs("div",{className:"d-flex justify-content-center align-items-center mt-4 flex-wrap",children:[e.jsx("button",{style:{maxWidth:"100px"},className:"btn btn-secondary mx-2",disabled:x===1,onClick:()=>H(x-1),children:"◀ Prev"}),re().map((t,s)=>t==="..."?e.jsx("span",{className:"mx-2 text-muted",children:"..."},s):e.jsx("button",{style:{maxWidth:"3vw"},className:`btn btn-sm mx-1 ${x===t?"btn-primary":"btn-outline-primary"}`,onClick:()=>H(t),children:t},s)),e.jsx("button",{style:{maxWidth:"100px"},className:"btn btn-secondary mx-2",disabled:x===w,onClick:()=>H(x+1),children:"Next ▶"})]})]})}const be=()=>e.jsx("div",{children:e.jsx(Se,{})});export{be as default};
